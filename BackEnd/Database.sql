-- MySQL Script generated by MySQL Workbench
-- Wed Sep 20 21:51:36 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Table `mydb`.`Preference`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `sw2projdb`.`Preference` (
  `idPreference` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `userEmail` VARCHAR(45) NOT NULL,
  `raEmail` VARCHAR(45) NOT NULL,
  `rdEmail` VARCHAR(45) NOT NULL,
  `resHall` VARCHAR(45) NULL,
  `floorNumber` INT NULL,
  `roomNumber` INT NULL,
  PRIMARY KEY (`idPreference`),
  UNIQUE INDEX `raEmail_UNIQUE` (`raEmail` ASC),
  UNIQUE INDEX `rdEmail_UNIQUE` (`rdEmail` ASC),
  UNIQUE INDEX `userEmail_UNIQUE` (`userEmail` ASC),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Work Order`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `sw2projdb`.`Work Order` (
  `idWork Order` INT NOT NULL,
  `Building` VARCHAR(45) NULL,
  `Coordinates` VARCHAR(45) NULL,
  `Description` TEXT NULL,
  `name` VARCHAR(45) NULL,
  `preferencesID` VARCHAR(45) NULL,
  `raEmail` VARCHAR(45) NULL,
  `rdEmail` VARCHAR(45) NULL,
  PRIMARY KEY (`idWork Order`),
  INDEX `name_idx` (`name` ASC),
  INDEX `raEmail_idx` (`raEmail` ASC),
  INDEX `rdEmail_idx` (`rdEmail` ASC),
  CONSTRAINT `name`
    FOREIGN KEY (`name`)
    REFERENCES `sw2projdb`.`Preference` (`name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `raEmail`
    FOREIGN KEY (`raEmail`)
    REFERENCES `sw2projdb`.`Preference` (`raEmail`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `rdEmail`
    FOREIGN KEY (`rdEmail`)
    REFERENCES `sw2projdb`.`Preference` (`rdEmail`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `preferencesID`
    FOREIGN KEY (`idWork Order`)
    REFERENCES `sw2projdb`.`Preference` (`idPreference`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Status`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `sw2projdb`.`Status` (
  `idStatus` INT NOT NULL,
  `workOrderID` INT NULL,
  `submissionDate` TIMESTAMP NULL,
  `status` TINYINT NULL,
  PRIMARY KEY (`idStatus`),
  INDEX `workOrderID_idx` (`workOrderID` ASC),
  CONSTRAINT `workOrderID`
    FOREIGN KEY (`workOrderID`)
    REFERENCES `sw2projdb`.`Work Order` (`idWork Order`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE USER 'user1';


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
